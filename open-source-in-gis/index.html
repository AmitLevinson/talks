<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>index.knit</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/leaflet/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet/leaflet.js"></script>
    <link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding/leaflet.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
  </head>
  <body>
    <textarea id="source">



```r
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = FALSE,
  message = FALSE, 
  warning = FALSE,
  fig.show = TRUE,
  hiline = TRUE
)
```



---
name: title-slide

.footnote[Add a nice cover image and info about me]

# "Learning GIS through mapping ice-cream parlers"

9.6.2021

"Open Source in GIS conference"
.small[Organized by Lior Kaplan]

Amit Levinson

[amitlevinson.com](https://www.amitlevinson.com)

Twitter icon | Linkedin Icon | GitHub Icon


---
# About me

- Sociology MA Graduate

- Been using R Programming lanugade for &lt; 2 years

- Enjoy open source tools (Linux, Git, MySQL)

- Had no idea what is GIS prior to using such tools

- Big fan of cookies &amp; milk

---

# Objectives for today


- Explore some of my initial attempts at spatial data

- Unravel my recent project as dive into GIS

- **Why is all this related to open source**

---
## How I first encountered data


```
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
```

---

## How I encountered ~spatial~ data.fn[1] (.shp)




```r
head(shelters[,2])
```

```
*## Simple feature collection with 6 features and 0 fields
*## Geometry type: POINT
*## Dimension:     XY
*## Bounding box:  xmin: 181680.1 ymin: 574027.4 xmax: 181972.9 ymax: 574304
*## Projected CRS: Israel 1993 / Israeli TM Grid
## # A tibble: 6 x 1
##              geometry
*##           &lt;POINT [m]&gt;
*## 1 (181710.6 574217.8)
## 2   (181680.1 574304)
## 3   (181820.6 574243)
## 4 (181819.3 574027.4)
## 5 (181972.9 574046.2)
## 6 (181912.3 574151.1)
```

[1] For the sake of simplicity and to reflect my learning process, I address spatial data here as a vector format (and not, for example, raster).


???
Fix foot note

---
background-image: url(https://media.giphy.com/media/kfLPQJRuivFwqGBxp3/giphy.gif)
background-size: contain


???

Gif credit: tenor.com
---

## Using long &amp; lat instead (.csv)


```
## # A tibble: 6 x 2
*##     lat   lon
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  31.3  34.8
## 2  31.3  34.8
## 3  31.3  34.8
## 4  31.3  34.8
## 5  31.3  34.8
## 6  31.3  34.8
```

<div id="htmlwidget-83cc07cacdaefad0f000" style="width:100%;height:252px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-83cc07cacdaefad0f000">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircles","args":[[31.2590187675396,31.2597950913285,31.2592493761368,31.2573049280621,31.2574797521349,31.2584240860229,31.2542462935938,31.2551730571648,31.2556456457674,31.2536662063123,31.2537330280115,31.2569812848333,31.2570752350887,31.2576080252637,31.2575462633198,31.2700855639908,31.2702904998564,31.2695012185507,31.2658482961647,31.2597254312193,31.2646111439267,31.2669213328596,31.2604320466847,31.2596058721797,31.2627628682758,31.2637890478405,31.261942934116,31.2638102081485,31.2632644712805,31.2635044445691,31.2624326140917,31.270858018428,31.2711996565257,31.270725645461,31.2712747302827,31.2718630295469,31.2720855328034,31.2726126789869,31.2704051919136,31.2667367735239,31.2628119166619,31.2455927187307,31.2489941513351,31.2501887472575,31.2459192306857,31.2467685799587,31.2479923816478,31.2478412889427,31.2493637843188,31.2501757721749,31.2487255472689,31.2486109038613,31.2518463622855,31.2518736099918,31.2509460673101,31.2535059490136,31.2578841038619,31.2540270012245,31.2559118880287,31.2710156907803,31.2712054965356,31.2703567223777,31.2699828417055,31.2698227121013,31.2693042090081,31.2699901155101,31.2687801063024,31.2682527530916,31.2683451451005,31.2706951584001,31.2732314696709,31.2733343198819,31.2737922810076,31.2728741077543,31.2742495924187,31.2746572611509,31.2723941746844,31.2739432401207,31.2744760078927,31.2717045566582,31.2729638222706,31.2757156429587,31.2741278412025,31.2746324349035,31.2745969015177,31.271494136931,31.2718457605035,31.2751410781932,31.2755894238599,31.2759297437177,31.2649303201111,31.2701039433272,31.2659409888961,31.2669887383613,31.269783330381,31.2704315436645,31.2665754737209,31.2661317455238,31.2215008067107,31.2241641939365,31.2235872281569,31.2258336939643,31.2220248008617,31.2197570487301,31.2212359184876,31.2249129927408,31.2240005864129,31.2261810245338,31.2230217343126,31.2238066000283,31.2209769778595,31.2229774706839,31.2321786256113,31.2324369338348,31.2431229219288,31.2359166169457,31.2388067926361,31.2370651278517,31.2482590678133,31.2514919092067,31.2504392378884,31.2504933065428,31.2518083161361,31.2461533773347,31.2506307391959,31.2556361501582,31.2566965172276,31.2549572052512,31.2572900994667,31.2546014400549,31.2565679325842,31.2550313006404,31.2575173868858,31.2579245334272,31.2579056490345,31.2226565674011,31.2245643450657,31.2426843957331,31.2402480091555,31.2399610088458,31.2679452170705,31.2638298578754,31.270236594911,31.269875347004,31.265144815518,31.269064833142,31.2681699773695,31.2693770843514,31.2657133154266,31.2709530353068,31.2722040716474,31.2645033746544,31.2712283692597,31.2715811000865,31.2566979243758,31.2571011614979,31.269666225639,31.2752812387082,31.274241078532,31.269109099018,31.2724057525699,31.2598086395987,31.2507073276984,31.2516781130975,31.252532109223,31.2486613237611,31.2554510694217,31.2490194846408,31.2670087990539,31.2682888352751,31.2693095026161,31.2508014168951,31.2680972673913,31.2679672846418,31.2671700043765,31.261017134569,31.2604871556024,31.2611714053168,31.2602866969803,31.2608564630037,31.2589570078961,31.2669088847001,31.2643123946932,31.2644250699634,31.2626755026444,31.2626283841319,31.2663541079584,31.2378694278326,31.2371961822354,31.2522976177335,31.2551276230653,31.2555366726751,31.2710092377443,31.2697859262952,31.2488988030131,31.250194782981,31.2501135935432,31.2487039561126,31.2482595926079,31.2476431947337,31.2529139570262,31.2562439010887,31.2502851068221,31.2561600821809,31.2510416859126,31.2497131785058,31.2581503514953,31.2590159165173,31.2581197602608,31.2555864897408,31.2571552971806,31.25491809243,31.2545320300235,31.2465726197361,31.2520725426748,31.2615997537859,31.2721663466169,31.2709716105806,31.2616581069513,31.2649733768095,31.2658491125039,31.2688886782476,31.2683040965445,31.2707125305716,31.2714282882924,31.2547690679734,31.2570706632388,31.2465921085953,31.2692059385969,31.2443915644984,31.2314304166571,31.2692081571502,31.2693630720598,31.2703085772936,31.2595743273088,31.2700607459555,31.256487557925,31.2479156198205,31.2481547411446,31.2548129546772,31.2665665018228,31.2504635084939,31.2541823774015,31.2683791259275,31.2713075444643,31.248295164423,31.2737507578221,31.2725907891505,31.2570404004693,31.251797270028,31.2663415997884,31.2709878494093,31.2660293332684,31.2540829301899,31.2701366484844,31.2402113957505,31.2646567781749,31.2463304386577,31.234778836859,31.2524282825481,31.2542104619949],[34.8082145455263,34.8078915737831,34.8093684379288,34.8093634951394,34.8109754364548,34.8103345681354,34.8056223820945,34.8026935251717,34.8044737680152,34.8095251010207,34.8075520781361,34.8085551863191,34.7651206136387,34.7636486199517,34.7628454487528,34.7786745041951,34.7777073988643,34.7762277096611,34.7701388440284,34.7869285289922,34.7951849435054,34.799772576073,34.7940810007154,34.7916208842495,34.7906790590812,34.7906895800661,34.7927366005044,34.7923145898524,34.7927492379425,34.7927439289692,34.7905235113319,34.7883433919403,34.7867639075706,34.7856029718721,34.7852056126641,34.787070295442,34.7875888165096,34.7939116199341,34.7941080743008,34.8014500783985,34.7921617720606,34.7956425144719,34.7970971841683,34.7970376863762,34.7936621444608,34.7914949661656,34.7848907462623,34.7875836140275,34.7873553953994,34.785714733149,34.7794223262576,34.7796193236756,34.7841264849533,34.7828629206097,34.7779282607524,34.7826047958599,34.7832538053148,34.7900850608261,34.7963698557953,34.8062381379971,34.8089210214324,34.8095852510316,34.8086036285547,34.8093572783017,34.8091260508627,34.8067740124649,34.8089092711627,34.8086805988741,34.8079129271552,34.8043232290746,34.8004399622041,34.8088667392032,34.8085067233771,34.8092444674213,34.80813547475,34.8077908654426,34.809621573771,34.8069308012966,34.8065025753978,34.8037255141811,34.8027768140487,34.8027325765395,34.8024465138945,34.8025668967473,34.8041253621481,34.8023649749831,34.8055181281872,34.8074389122186,34.8070149956564,34.8064910510278,34.7604294980062,34.7639117038642,34.7656210942173,34.7664207514732,34.7608955093895,34.7630732060148,34.7598450789332,34.7611068102951,34.7755402736122,34.7789006306464,34.7774103085656,34.7786002737103,34.7726666249125,34.7737241958086,34.7718155209957,34.7756690438539,34.7802354011142,34.7802695861898,34.7763314487779,34.7753087161763,34.7743583124685,34.7736159985069,34.7923748974428,34.7803395296423,34.7797387812644,34.7843807637824,34.7847258244155,34.7817552396756,34.792498504234,34.7868126544073,34.7899838937908,34.7891288251005,34.7879533316788,34.7942136409243,34.7945532957907,34.7903546793989,34.7959888820638,34.7941725484816,34.7954034447909,34.789144361472,34.7939071729267,34.7965041999837,34.7892947975503,34.7815478664668,34.7836561207773,34.7751580728716,34.7809179472187,34.7818223115386,34.7816178325285,34.7833443348166,34.7623511374746,34.7626429288703,34.7717859493022,34.7709577196902,34.763615392898,34.7619093161369,34.764463337002,34.7648728465828,34.757781215623,34.770979357923,34.7656731032732,34.7643799361797,34.7675474783923,34.7695298170027,34.7733056724037,34.7734153675627,34.8052937234124,34.8052675854359,34.8008910165946,34.8083069866317,34.8067210748557,34.8088518341144,34.8019847366436,34.8065743967006,34.8100138710781,34.808126409048,34.7780347283283,34.7826202352301,34.7707858408181,34.7723190739081,34.7748944220297,34.7791817603049,34.794869849621,34.7970907803294,34.7950072932982,34.7970251097779,34.7965872194229,34.7953386146037,34.7935443279932,34.7929193076892,34.7929353972874,34.7939598032084,34.7952477983951,34.7970732172085,34.7944644402979,34.7974265892205,34.7929976419106,34.7854920214553,34.7889980751767,34.8049458930033,34.8100962183314,34.8087161111233,34.7833962786941,34.7850399334532,34.7959989748965,34.8051394360077,34.802841956255,34.8061534388525,34.8043447073948,34.8072640525026,34.8114628898763,34.8061851884499,34.8065675973891,34.810376580183,34.8036954798426,34.8085987035646,34.8112338245417,34.8098430128997,34.809443568161,34.8080172913365,34.8103342348703,34.8070907056384,34.8035195025696,34.808605526325,34.8028611368041,34.7937478428836,34.7956186756091,34.7935861411886,34.7919188426311,34.7999293699408,34.8011879877967,34.8012474812238,34.7923452669496,34.7969623870428,34.7947667568401,34.8086733958785,34.8068701704998,34.7765876850618,34.7929410700874,34.7910700988533,34.7935582578561,34.7954634880451,34.7948531973248,34.7868227163075,34.7857320463115,34.7956530029318,34.7913958377986,34.7796560834964,34.7810081782112,34.7789808403915,34.7948730217942,34.7805699274727,34.8023777061705,34.7968104340772,34.7835411999931,34.7892121184839,34.8070383389814,34.808019280238,34.8085495815285,34.8025542944436,34.7698468989514,34.8072728061055,34.800862999318,34.8116456559907,34.784290407836,34.7950379799485,34.7961240605124,34.8083349925268,34.7825503888472,34.8081491537365,34.7884126900171],4,null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[31.2197570487301,31.2759297437177],"lng":[34.757781215623,34.8116456559907]}},"evals":[],"jsHooks":[]}</script>

???

Fix up highlighting the column

---

## It's time to to learn some GIS

- Tried some additional attempts in the #30daysmapchallenge

- Fiddled around and sometimes hit home

- Realized it's time to get my hand dirty in some spatial data

![]()

---
class: inverse, center, middle

# Exploring distances and ice-cream parlors

---
# Background

.pull-left[
### Inspiration

&lt;iframe src='https://dominicroye.github.io/en/2019/calculating-the-distance-to-the-sea-in-r/' width = 600 height = 300&gt;&lt;/iframe&gt;
]

.pull-right[
### Some serendipitous resources

Michael Dorman's workshop

]

- Let's explore distances!

+

- I really like Golda's ice-cream



---

# Data

Where do you find Golda's ice-cream locations?

--

![](img/golda_css.png)
---

# Data collection

- [Scrape the data from the website](https://github.com/AmitLevinson/Datasets/blob/master/golda/golda-icecreams.R)


```
## [1] "\nאור עקיבא\n\nכשר\nהשקמים 8\n04-646-0705\n\n"
```

--

- Clean it

--

- Geocode the data to get lat &amp; long from addresses

--

- Reverse geocode the long &amp; lat and verify each address.

--

Final output looked like this (total of 79 addresses):

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; city &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; street &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; number &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; location &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lon &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lat &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; google_address &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; אור עקיבא &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; השקמים 8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 04-646-0705 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; השקמים 8, אור עקיבא &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.91794 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.50436 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Ha-Shikmim St 8, Or Akiva, Israel &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


--

Discrepancies were manually verified (though I probably verified everything anyway).

---
background-image: url(img/worst_day_top.jpg)
background-size: contain
---
background-image: url(img/worst_day_full.jpg)
background-size: contain

---
## st_transform

- our initial golda points come as long &amp; lat.

- we need it as geographic coordinates for a plot, and as projected for calculating distances.


ADD PLOT WITH POINTS



???

I wanted to enable users to interact with the map so leaflet was important here (and not, for example, ggplot)



---

## st_

- We want to calculate distances, but to where?

- Use grids as specific locations

MAP OF israel in grids

???
The grids help overcoming the reactivity we might find in web based apps



---

## st_centroid

- But even with a grid, we can take it one step further.

- Find a specific location so it's similar across all points.

[ADD various polygons using st_centroid]

--- 

## st_distance

Now we're ready


We now have our grids and 

---
- Add disclaimer about my knowledge - tip of the ice
- [ ] Explore some of my initial attempts at spatial data

   - How was I used to working with data?
  
   - First attempt at plotting bomb shelters - B7 open access data
  
   - What is this column and weird data format?
  
   - Oh I know, final output
  
   - very nice and excited
 
 - 30 daymapchallenge
 
    - 1 example of population plot enhancing
    
- [ ] Unravel my recent project and what it taught me about working with GIS

  - I realized I don't know and want to learn more: What on earth are projections? What ~the hell~ is a raster? how can I manipulate polygons? What are some cool things in the {sf} library? How can we add interactivity to a map? and what should I do it on?

  - Well let's explore distances, that seems cool. Also came across Dominic's blog post.
  
  - Collecting the data using R
    - scraping
    - geocoding it
    - reverse geocoding it
    - Manually verify locations
    
  - OK, preliminary plot, so far so good.
  
  - Now for distances, but distance from where?
    - we need something 'specific'
    - Create grids, but what are grids?
    - and what proejction do I need?
  - Short break, luckily Michael published X during when I was working on it.
  
  - Got it, but what exactly occurs here?
  
    - So I published a small post on it, small wins
    - Plus, it got the most attention of a LinkedIn post so far.
    
  - So we cut Israel into grids, now what?
    - Calculate the distance for each square grid.
    - Any distance? where it's at minimum!
    - example for one grid
    - now for all grids a N * M matrix
    
  - Ok, but let's add interactivity
    - use leaflet to the polygon and colors
    - but also with some simple html &amp; CSS we add a neat layer of interactivity
  
  - Publish
  
  - Feedback (good)
    - Email saying it helped them do X
    - an email someone liking it but suggesting an improvement! How much improved? by XX seconds.
    - Learn more about maps
    
    - Feedback (bad?)
      - Why a 2 squared km?
      - Why Golda? don't have anything else interesting to do about?
      
- [ ] How's all this related to open source
  - Not sure I would have done it if I'd still be using my previously learned propreitary software (SPSS)
  - Extending my already-known-tool to use it in maps
  - Contributing back to the community
  - FREE
  - Code is accessible to explore and manipulate
  - Expanding my repoirtere of skills

---



background-image: url(https://upload.wikimedia.org/wikipedia/commons/b/be/Sharingan_triple.svg)



???

Image credit: [Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Sharingan_triple.svg)

---
class: center, middle

# xaringan

### /ʃaː.'riŋ.ɡan/

---
class: inverse, center, middle

# Get Started

---

# Hello World

Install the **xaringan** package from [Github](https://github.com/yihui/xaringan):



--

You are recommended to use the [RStudio IDE](https://www.rstudio.com/products/rstudio/), but you do not have to.

- Create a new R Markdown document from the menu `File -&gt; New File -&gt; R Markdown -&gt; From Template -&gt; Ninja Presentation`;&lt;sup&gt;1&lt;/sup&gt;

--

- Click the `Knit` button to compile it;

--

- or use the [RStudio Addin](https://rstudio.github.io/rstudioaddins/)&lt;sup&gt;2&lt;/sup&gt; "Infinite Moon Reader" to live preview the slides (every time you update and save the Rmd document, the slides will be automatically reloaded in RStudio Viewer.

.footnote[
[1] 中文用户请看[这份教程](https://slides.yihui.org/xaringan/zh-CN.html)

[2] See [#2](https://github.com/yihui/xaringan/issues/2) if you do not see the template or addin in RStudio.
]

---
background-image: url(https://github.com/yihui/xaringan/releases/download/v0.0.2/karl-moustache.jpg)
background-position: 50% 50%
class: center, bottom, inverse

# You only live once!

---

# Hello Ninja

As a presentation ninja, you certainly should not be satisfied by the "Hello World" example. You need to understand more about two things:

1. The [remark.js](https://remarkjs.com) library;

1. The **xaringan** package;

Basically **xaringan** injected the chakra of R Markdown (minus Pandoc) into **remark.js**. The slides are rendered by remark.js in the web browser, and the Markdown source needed by remark.js is generated from R Markdown (**knitr**).

---

# remark.js

You can see an introduction of remark.js from [its homepage](https://remarkjs.com). You should read the [remark.js Wiki](https://github.com/gnab/remark/wiki) at least once to know how to

- create a new slide (Markdown syntax&lt;sup&gt;*&lt;/sup&gt; and slide properties);

- format a slide (e.g. text alignment);

- configure the slideshow;

- and use the presentation (keyboard shortcuts).

It is important to be familiar with remark.js before you can understand the options in **xaringan**.

.footnote[[*] It is different with Pandoc's Markdown! It is limited but should be enough for presentation purposes. Come on... You do not need a slide for the Table of Contents! Well, the Markdown support in remark.js [may be improved](https://github.com/gnab/remark/issues/142) in the future.]

---
background-image: url(https://github.com/yihui/xaringan/releases/download/v0.0.2/karl-moustache.jpg)
background-size: cover
class: center, bottom, inverse

# I was so happy to have discovered remark.js!

---
class: inverse, middle, center

# Using xaringan

---

# xaringan

Provides an R Markdown output format `xaringan::moon_reader` as a wrapper for remark.js, and you can use it in the YAML metadata, e.g.

```yaml
---
title: "A Cool Presentation"
output:
  xaringan::moon_reader:
    yolo: true
    nature:
      autoplay: 30000
---
```

See the help page `?xaringan::moon_reader` for all possible options that you can use.

---

# remark.js vs xaringan

Some differences between using remark.js (left) and using **xaringan** (right):

.pull-left[
1. Start with a boilerplate HTML file;

1. Plain Markdown;

1. Write JavaScript to autoplay slides;

1. Manually configure MathJax;

1. Highlight code with `*`;

1. Edit Markdown source and refresh browser to see updated slides;
]

.pull-right[
1. Start with an R Markdown document;

1. R Markdown (can embed R/other code chunks);

1. Provide an option `autoplay`;

1. MathJax just works;&lt;sup&gt;*&lt;/sup&gt;

1. Highlight code with `{{}}`;

1. The RStudio addin "Infinite Moon Reader" automatically refreshes slides on changes;
]

.footnote[[*] Not really. See next page.]

---

# Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &amp;#36;\alpha+\beta$ renders `\(\alpha+\beta\)`. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

`$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$`

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

# R Code


```
#               Estimate Std. Error   t value     Pr(&gt;|t|)
# (Intercept) -17.579095  6.7584402 -2.601058 1.231882e-02
# speed         3.932409  0.4155128  9.463990 1.489836e-12
```

```
# character(0)
```

---

# R Plots

&lt;img src="index_files/figure-html/cars-1.svg" width="100%" /&gt;

---

# Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Sepal.Width &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Petal.Width &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Species &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; setosa &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# HTML Widgets

I have not thoroughly tested HTML widgets against **xaringan**. Some may work well, and some may not. It is a little tricky.

Similarly, the Shiny mode (`runtime: shiny`) does not work. I might get these issues fixed in the future, but these are not of high priority to me. I never turn my presentation into a Shiny app. When I need to demonstrate more complicated examples, I just launch them separately. It is convenient to share slides with other people when they are plain HTML/JS applications.

See the next page for two HTML widgets.

---

<div id="htmlwidget-8d1284f87b69c2b87a00" style="width:100%;height:432px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8d1284f87b69c2b87a00">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}],"setView":[[42.0285,-93.65],17,[]]},"evals":[],"jsHooks":[]}</script>

---

<div id="htmlwidget-8e159b749288d16065d8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8e159b749288d16065d8">{"x":{"filter":"none","fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9],[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1],[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5],[0.2,0.2,0.2,0.2,0.2,0.4,0.3,0.2,0.2,0.1],["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Sepal.Length<\/th>\n      <th>Sepal.Width<\/th>\n      <th>Petal.Length<\/th>\n      <th>Petal.Width<\/th>\n      <th>Species<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---

# Some Tips

- Do not forget to try the `yolo` option of `xaringan::moon_reader`.

    ```yaml
    output:
      xaringan::moon_reader:
        yolo: true
    ```

---

# Some Tips

- Slides can be automatically played if you set the `autoplay` option under `nature`, e.g. go to the next slide every 30 seconds in a lightning talk:

    ```yaml
    output:
      xaringan::moon_reader:
        nature:
          autoplay: 30000
    ```

- If you want to restart the play after it reaches the last slide, you may set the sub-option `loop` to TRUE, e.g.,

    ```yaml
    output:
      xaringan::moon_reader:
        nature:
          autoplay:
            interval: 30000
            loop: true
    ```

---

# Some Tips

- A countdown timer can be added to every page of the slides using the `countdown` option under `nature`, e.g. if you want to spend one minute on every page when you give the talk, you can set:

    ```yaml
    output:
      xaringan::moon_reader:
        nature:
          countdown: 60000
    ```

    Then you will see a timer counting down from `01:00`, to `00:59`, `00:58`, ... When the time is out, the timer will continue but the time turns red.
    
---

# Some Tips

- The title slide is created automatically by **xaringan**, but it is just another remark.js slide added before your other slides.

    The title slide is set to `class: center, middle, inverse, title-slide` by default. You can change the classes applied to the title slide with the `titleSlideClass` option of `nature` (`title-slide` is always applied).

    ```yaml
    output:
      xaringan::moon_reader:
        nature:
          titleSlideClass: [top, left, inverse]
    ```
    
--

- If you'd like to create your own title slide, disable **xaringan**'s title slide with the `seal = FALSE` option of `moon_reader`.

    ```yaml
    output:
      xaringan::moon_reader:
        seal: false
    ```

---

# Some Tips

- There are several ways to build incremental slides. See [this presentation](https://slides.yihui.org/xaringan/incremental.html) for examples.

- The option `highlightLines: true` of `nature` will highlight code lines that start with `*`, or are wrapped in `{{ }}`, or have trailing comments `#&lt;&lt;`;

    ```yaml
    output:
      xaringan::moon_reader:
        nature:
          highlightLines: true
    ```

    See examples on the next page.

---

# Some Tips


.pull-left[
An example using a leading `*`:

    ```r
    if (TRUE) {
    ** message("Very important!")
    }
    ```
Output:
```r
if (TRUE) {
* message("Very important!")
}
```

This is invalid R code, so it is a plain fenced code block that is not executed.
]

.pull-right[
An example using `{{}}`:

````
```{r tidy=FALSE}
if (TRUE) {
*{{ message("Very important!") }}
}
```
````
Output:


It is valid R code so you can run it. Note that `{{}}` can wrap an R expression of multiple lines.
]

---

# Some Tips

An example of using the trailing comment `#&lt;&lt;` to highlight lines:

````markdown
```{r tidy=FALSE}
library(ggplot2)
ggplot(mtcars) + 
  aes(mpg, disp) + 
  geom_point() +   #&lt;&lt;
  geom_smooth()    #&lt;&lt;
```
````

Output:



---

# Some Tips

When you enable line-highlighting, you can also use the chunk option `highlight.output` to highlight specific lines of the text output from a code chunk. For example, `highlight.output = TRUE` means highlighting all lines, and `highlight.output = c(1, 3)` means highlighting the first and third line.

````md
```{r, highlight.output=c(1, 3)}
head(iris)
```
````


```
*##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
*## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
```

Question: what does `highlight.output = c(TRUE, FALSE)` mean? (Hint: think about R's recycling of vectors)

---

# Some Tips

- To make slides work offline, you need to download a copy of remark.js in advance, because **xaringan** uses the online version by default (see the help page `?xaringan::moon_reader`).

- You can use `xaringan::summon_remark()` to download the latest or a specified version of remark.js. By default, it is downloaded to `libs/remark-latest.min.js`.

- Then change the `chakra` option in YAML to point to this file, e.g.

    ```yaml
    output:
      xaringan::moon_reader:
        chakra: libs/remark-latest.min.js
    ```

- If you used Google fonts in slides (the default theme uses _Yanone Kaffeesatz_, _Droid Serif_, and _Source Code Pro_), they won't work offline unless you download or install them locally. The Heroku app [google-webfonts-helper](https://google-webfonts-helper.herokuapp.com/fonts) can help you download fonts and generate the necessary CSS.

---

# Macros

- remark.js [allows users to define custom macros](https://github.com/yihui/xaringan/issues/80) (JS functions) that can be applied to Markdown text using the syntax `![:macroName arg1, arg2, ...]` or `![:macroName arg1, arg2, ...](this)`. For example, before remark.js initializes the slides, you can define a macro named `scale`:

    ```js
    remark.macros.scale = function (percentage) {
      var url = this;
      return '&lt;img src="' + url + '" style="width: ' + percentage + '" /&gt;';
    };
    ```

    Then the Markdown text

    ```markdown
    ![:scale 50%](image.jpg)
    ```

    will be translated to
    
    ```html
    &lt;img src="image.jpg" style="width: 50%" /&gt;
    ```

---

# Macros (continued)

- To insert macros in **xaringan** slides, you can use the option `beforeInit` under the option `nature`, e.g.,

    ```yaml
    output:
      xaringan::moon_reader:
        nature:
          beforeInit: "macros.js"
    ```

    You save your remark.js macros in the file `macros.js`.

- The `beforeInit` option can be used to insert arbitrary JS code before `remark.create()`. Inserting macros is just one of its possible applications.

---

# CSS

Among all options in `xaringan::moon_reader`, the most challenging but perhaps also the most rewarding one is `css`, because it allows you to customize the appearance of your slides using any CSS rules or hacks you know.

You can see the default CSS file [here](https://github.com/yihui/xaringan/blob/master/inst/rmarkdown/templates/xaringan/resources/default.css). You can completely replace it with your own CSS files, or define new rules to override the default. See the help page `?xaringan::moon_reader` for more information.

---

# CSS

For example, suppose you want to change the font for code from the default "Source Code Pro" to "Ubuntu Mono". You can create a CSS file named, say, `ubuntu-mono.css`:

```css
@import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

.remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
```

Then set the `css` option in the YAML metadata:

```yaml
output:
  xaringan::moon_reader:
    css: ["default", "ubuntu-mono.css"]
```

Here I assume `ubuntu-mono.css` is under the same directory as your Rmd.

See [yihui/xaringan#83](https://github.com/yihui/xaringan/issues/83) for an example of using the [Fira Code](https://github.com/tonsky/FiraCode) font, which supports ligatures in program code.

---

# CSS (with Sass)

**xaringan** also supports Sass support via **rmarkdown**. Suppose you want to use the same color for different elements, e.g., first heading and bold text. You can create a `.scss` file, say `mytheme.scss`, using the [sass](https://sass-lang.com/) syntax with variables:

```scss
$mycolor: #ff0000; 
.remark-slide-content &gt; h1 { color: $mycolor; }
.remark-slide-content strong { color: $mycolor; }
```

Then set the `css` option in the YAML metadata using this file placed under the same directory as your Rmd:

```yaml
output:
  xaringan::moon_reader:
    css: ["default", "mytheme.scss"]
```

This requires **rmarkdown** &gt;= 2.8 and the [**sass**](https://rstudio.github.io/sass/) package. You can learn more about **rmarkdown** and **sass** support in [this blog post](https://blog.rstudio.com/2021/04/15/2021-spring-rmd-news/#sass-and-scss-support-for-html-based-output) and in [**sass** overview vignette](https://rstudio.github.io/sass/articles/sass.html).

---

# Themes

Don't want to learn CSS? Okay, you can use some user-contributed themes. A theme typically consists of two CSS files `foo.css` and `foo-fonts.css`, where `foo` is the theme name. Below are some existing themes:


```
##  [1] "chocolate-fonts"  "chocolate"        "default-fonts"   
##  [4] "default"          "duke-blue"        "fc-fonts"        
##  [7] "fc"               "hygge-duke"       "hygge"           
## [10] "ki-fonts"         "ki"               "kunoichi"        
## [13] "lucy-fonts"       "lucy"             "metropolis-fonts"
## [16] "metropolis"       "middlebury-fonts" "middlebury"      
## [19] "nhsr-fonts"       "nhsr"             "ninjutsu"        
## [22] "rladies-fonts"    "rladies"          "robot-fonts"     
## [25] "robot"            "rutgers-fonts"    "rutgers"         
## [28] "shinobi"          "tamu-fonts"       "tamu"            
## [31] "uio-fonts"        "uio"              "uo-fonts"        
## [34] "uo"               "uol-fonts"        "uol"             
## [37] "useR-fonts"       "useR"
```

---

# Themes

To use a theme, you can specify the `css` option as an array of CSS filenames (without the `.css` extensions), e.g.,

```yaml
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts]
```

If you want to contribute a theme to **xaringan**, please read [this blog post](https://yihui.org/en/2017/10/xaringan-themes).

---
class: inverse, middle, center
background-image: url(https://upload.wikimedia.org/wikipedia/commons/3/39/Naruto_Shiki_Fujin.svg)
background-size: contain

# Naruto

---
background-image: url(https://upload.wikimedia.org/wikipedia/commons/b/be/Sharingan_triple.svg)
background-size: 100px
background-position: 90% 8%

# Sharingan

The R package name **xaringan** was derived&lt;sup&gt;1&lt;/sup&gt; from **Sharingan**, a dōjutsu in the Japanese anime _Naruto_ with two abilities:

- the "Eye of Insight"

- the "Eye of Hypnotism"

I think a presentation is basically a way to communicate insights to the audience, and a great presentation may even "hypnotize" the audience.&lt;sup&gt;2,3&lt;/sup&gt;

.footnote[
[1] In Chinese, the pronounciation of _X_ is _Sh_ /ʃ/ (as in _shrimp_). Now you should have a better idea of how to pronounce my last name _Xie_.

[2] By comparison, bad presentations only put the audience to sleep.

[3] Personally I find that setting background images for slides is a killer feature of remark.js. It is an effective way to bring visual impact into your presentations.
]

---

# Naruto terminology

The **xaringan** package borrowed a few terms from Naruto, such as

- [Sharingan](https://naruto.fandom.com/wiki/Sharingan) (写輪眼; the package name)

- The [moon reader](https://naruto.fandom.com/wiki/Moon_Reader) (月読; an attractive R Markdown output format)

- [Chakra](https://naruto.fandom.com/wiki/Chakra) (查克拉; the path to the remark.js library, which is the power to drive the presentation)

- [Nature transformation](https://naruto.fandom.com/wiki/Nature_Transformation) (性質変化; transform the chakra by setting different options)

- The [infinite moon reader](https://naruto.fandom.com/wiki/Infinite_Tsukuyomi) (無限月読; start a local web server to continuously serve your slides)

- The [summoning technique](https://naruto.fandom.com/wiki/Summoning_Technique) (download remark.js from the web)

You can click the links to know more about them if you want. The jutsu "Moon Reader" may seem a little evil, but that does not mean your slides are evil.

---

class: center

# Hand seals (印)

Press `h` or `?` to see the possible ninjutsu you can use in remark.js.

![](https://upload.wikimedia.org/wikipedia/commons/7/7e/Mudra-Naruto-KageBunshin.svg)

---

class: center, middle

# Thanks!

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](https://yihui.org/knitr/), and [R Markdown](https://rmarkdown.rstudio.com).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<script>
(function() {
  var divHTML = document.querySelectorAll(".details");
  divHTML.forEach(function (el) {
    var preNodes = el.getElementsByTagName("pre");
    if (preNodes.length < 2) return;
    var outputNode = preNodes[1];
    outputNode.outerHTML = "<details " +
      (el.classList.contains("open") ? "open " : "") +
      "class='output'><summary>Output</summary>" +
      outputNode.outerHTML + "</details>";
  })
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
